CONTIKI_PROJECT = rpl-node
all: $(CONTIKI_PROJECT)

# Try to find CONTIKI directory
CONTIKI ?= $(shell if [ -d ../../contiki-ng-brpl ]; then realpath ../../contiki-ng-brpl; elif [ -d ../../../contiki-ng-brpl ]; then realpath ../../../contiki-ng-brpl; else echo "../../contiki-ng-brpl"; fi)

MAKE_ROUTING ?= MAKE_ROUTING_RPL_CLASSIC
MAKE_MAC ?= MAKE_MAC_CSMA
MAKE_RDC ?= MAKE_RDC_NULLRDC

ATTACKER_ID ?= 6
ATTACK_RATE ?= 0.0
ROOT_ID ?= 1
SEND_INTERVAL ?= 30
SEND_JITTER ?= 5
DATA_PORT ?= 3000
ATTACK_STATS_PERIOD ?= 300

CFLAGS += -DATTACKER_ID=$(ATTACKER_ID)
CFLAGS += -DATTACK_RATE=$(ATTACK_RATE)
CFLAGS += -DROOT_ID=$(ROOT_ID)
CFLAGS += -DSEND_INTERVAL=$(SEND_INTERVAL)
CFLAGS += -DSEND_JITTER=$(SEND_JITTER)
CFLAGS += -DDATA_PORT=$(DATA_PORT)
CFLAGS += -DATTACK_STATS_PERIOD=$(ATTACK_STATS_PERIOD)
CFLAGS += -DRPL_CONF_DIO_INTERVAL_MIN=9
CFLAGS += -DRPL_CONF_DIO_INTERVAL_DOUBLINGS=1

ifeq ($(BRPL),1)
CFLAGS += -DBRPL_CONF_ENABLE=1
CFLAGS += -DRPL_CONF_OF_OCP=RPL_OCP_BRPL
endif

include $(CONTIKI)/Makefile.dir-variables
include $(CONTIKI)/Makefile.include
